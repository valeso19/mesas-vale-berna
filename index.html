<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Mesas Vale Berna</title>
  <link rel="manifest" href="manifest.json" />
</head>
<body>
  <header id="header" style="display:none;">
    <h1>Mesas Vale Berna</h1>
  </header>
  
  <main id="main" style="display:none;">
    <p>Aquí se mostrarán los datos de los invitados.</p>
  </main>
  
  <div id="loading">Cargando datos...</div>

  <!-- ENVOLVER el input password en un form para evitar warning -->
  <form id="verification-form">
    <input type="password" id="code-input" placeholder="Código de verificación" />
  </form>

  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
    import { getDatabase, ref, onValue } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-database.js";

    const firebaseConfig = {
      apiKey: "TU_APIKEY_AQUI",
      authDomain: "mesas-vale-berna.firebaseapp.com",
      databaseURL: "https://mesas-vale-berna-default-rtdb.firebaseio.com",
      projectId: "mesas-vale-berna",
      storageBucket: "mesas-vale-berna.appspot.com",
      messagingSenderId: "XXXXXXXXXXXX",
      appId: "X:XXXXXXXXXXXX:web:XXXXXXXXXXXXXX"
    };

    const app = initializeApp(firebaseConfig);
    const database = getDatabase(app);
    const invitadosRef = ref(database, 'invitados');

    onValue(invitadosRef,
      (snapshot) => {
        const data = snapshot.val();
        console.log('Datos recibidos de Firebase:', data);

        if (data) {
          // Aquí va el código que procesa y muestra los datos de invitados
          console.log("Procesando datos de invitados...");
          const header = document.getElementById('header');
          const main = document.getElementById('main');
          const loading = document.getElementById('loading');
          if (loading) loading.style.display = 'none';
          if (header) header.style.display = 'block';
          if (main) main.style.display = 'block';
        } else {
          console.warn('No se encontraron datos en la base de datos.');
        }
      },
      (error) => {
        console.error('Error cargando datos de Firebase:', error);
        alert("Error al cargar datos, revisa la consola para más detalles.");
        const loading = document.getElementById('loading');
        if (loading) loading.style.display = 'none';
      }
    );
  </script>
</body>
</html>
